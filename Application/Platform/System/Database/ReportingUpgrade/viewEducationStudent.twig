SELECT distinct

-- PersonId to match with all View's // tblDivisionStudent
    tDS.serviceTblPerson AS TblPerson_Id,
-- tblLevel
    tL.Id AS TblLevel_Id,
    tL.Name AS TblLevel_Name,
    tL.Description AS TblLevel_Description,
    tL.IsChecked AS TblLevel_IsChecked,
-- tblDivision
    tD.Name AS TblDivision_Name,
    tD.Description AS TblDivision_Description,
    concat(tL.Name, tD.Name) as TblDivision_Display,
-- tblType
    tT.Name AS TblType_Name,
    tT.Description AS TblType_Description,
-- tblYear
    (CASE WHEN (ISNULL(tY.Year) OR (tY.Year = '')) THEN tY.Name ELSE tY.Year END) AS TblYear_Year,
    tY.Description AS TblYear_Description

FROM EducationLessonDivision_{{ ConsumerAcronym }}.tblDivisionStudent tDS
	LEFT JOIN EducationLessonDivision_{{ ConsumerAcronym }}.tblDivision tD ON tD.Id = tDS.tblDivision
		AND tD.EntityRemove IS NULL
	LEFT JOIN EducationLessonDivision_{{ ConsumerAcronym }}.tblLevel tL ON tL.Id = tD.tblLevel
		AND tL.EntityRemove IS NULL
	LEFT JOIN EducationSchoolType_{{ ConsumerAcronym }}.tblType tT ON tT.Id = tL.serviceTblType
	LEFT JOIN EducationLessonTerm_{{ ConsumerAcronym }}.tblYear tY ON tY.Id = tD.serviceTblYear
-- 	LEFT JOIN EducationLessonTerm_{{ ConsumerAcronym }}.tblYearPeriod tYP ON tYP.tblYear = tY.Id
-- 	LEFT JOIN EducationLessonTerm_{{ ConsumerAcronym }}.tblPeriod tP ON tP.Id = tYP.tblPeriod
WHERE tDS.EntityRemove IS NULL and
	(tDS.LeaveDate is null
	or (tDS.LeaveDate is not null and CURRENT_TIMESTAMP() <= tDS.LeaveDate))
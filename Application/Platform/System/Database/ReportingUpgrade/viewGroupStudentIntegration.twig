SELECT
    tS.serviceTblPerson AS TblPerson_Id,
    tS.Id AS TblStudent_Id,

    (select distinct
        group_concat(
            concat(
                tSFT.Name
            ) separator ', \n'
        )
    from PeopleMeta_{{ ConsumerAcronym }}.tblSupport tSU
        LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblSupportFocus tSF ON tSF.tblSupport = tSU.Id
        LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblSupportFocusType tSFT ON tSFT.Id = tSF.tblSupportFocusType
    where tSU.serviceTblPerson = tS.serviceTblPerson
        and tSU.EntityRemove IS NULL
    ) TblStudentFocusType_NameList,

    (select
        tSFT.Name
    from PeopleMeta_{{ ConsumerAcronym }}.tblSupport tSU
        LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblSupportFocus tSF ON tSF.tblSupport = tSU.Id
        LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblSupportFocusType tSFT ON tSFT.Id = tSF.tblSupportFocusType
    where tSU.serviceTblPerson = tS.serviceTblPerson
        and tSU.EntityRemove IS NULL
        and tSF.IsPrimary = 1
        limit 1
    ) TblStudentFocusType_MainFocus,
    
    (select
        group_concat(
            concat(
                tSDT.Name
            ) separator ', \n'
        )
    from PeopleMeta_{{ ConsumerAcronym }}.tblStudentDisorder tSD
        LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblStudentDisorderType tSDT ON tSDT.Id = tSD.tblStudentDisorderType
    where tSD.tblStudent = tS.Id
        and tSD.EntityRemove IS NULL
    ) TblStudentDisorderType_NameList,
    
    DATE_FORMAT( tSI.CoachingRequestDate, '%d.%m.%Y' ) AS TblStudentIntegration_CoachingRequestDate,
    DATE_FORMAT( tSI.CoachingCounselDate, '%d.%m.%Y' ) AS TblStudentIntegration_CoachingCounselDate,
    DATE_FORMAT( tSI.CoachingDecisionDate, '%d.%m.%Y' ) AS TblStudentIntegration_CoachingDecisionDate,
    IF (tSI.CoachingRequired, 'Ja', 'Nein') AS TblStudentIntegration_CoachingRequired,
    tSI.CoachingTime AS TblStudentIntegration_CoachingTime,
    tSI.CoachingRemark AS TblStudentIntegration_CoachingRemark,
    
    concat(
        tP.FirstName,
        ' ',
        tP.LastName
    ) as TblPerson_Coach

FROM PeopleMeta_{{ ConsumerAcronym }}.tblStudent tS
    LEFT JOIN PeopleMeta_{{ ConsumerAcronym }}.tblStudentIntegration tSI ON tSI.Id = tS.tblStudentIntegration
    LEFT JOIN PeoplePerson_{{ ConsumerAcronym }}.tblPerson tP ON tP.Id = tSI.serviceTblPerson